---
- name: run timesync playbook
  import_playbook: ./timesync.yaml

- name: setup slurm
  hosts: localhost
  tasks:
  - name: create slurm user
    user:
      name: slurm
      system: true
  - name: install slurm packages
    yum:
      name: "{{ item }}"
      state: present
    loop:
      - munge
      - munge-libs
      - slurm
      - slurm-perlapi
  - name: install slurmd
    yum:
      name: slurm-slurmd
      state: present
  - name: create slurm group
    group:
      name: slurm
      state: present
      gid: 985

  - name: enable munge
    shell: 'systemctl enable munge'
